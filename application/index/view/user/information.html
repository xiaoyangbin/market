<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1.0, user-scalable=0">

	<title>个人资料</title>
	<script src="__STATIC____INDEX__/js/jquery-1.9.1.min.js" type="text/javascript"></script>
	<link href="__STATIC____INDEX__/AmazeUI-2.4.2/assets/css/admin.css" rel="stylesheet" type="text/css">
	<link href="__STATIC____INDEX__/AmazeUI-2.4.2/assets/css/amazeui.css" rel="stylesheet" type="text/css">
	<link href="__STATIC____INDEX__/css/personal.css" rel="stylesheet" type="text/css">
	<link href="__STATIC____INDEX__/css/infstyle.css" rel="stylesheet" type="text/css">
	<script src="__STATIC____INDEX__/AmazeUI-2.4.2/assets/js/jquery.min.js" type="text/javascript"></script>
	<script src="__STATIC____INDEX__/AmazeUI-2.4.2/assets/js/amazeui.js" type="text/javascript"></script>
	<script src="__STATIC____INDEX__/layer/layer.js"></script>

</head>

<body>
	<!--头 -->
	<header>
		<article>
			<div class="mt-logo">
				<!--悬浮搜索框-->
				<div class="nav white">
					<div class="logoBig">
							<li><a href="{:url('index/index/index')}"><img src="__STATIC____INDEX__/images/logobig.png" /></a></li>
					</div>

					<div class="search-bar pr">
						<a name="index_none_header_sysc" href="#"></a>
						<form>
							<input id="searchInput" name="index_none_header_sysc" type="text" placeholder="搜索"
								autocomplete="off">
							<input id="ai-topsearch" class="submit am-btn" value="搜索" index="1" type="submit">
						</form>
					</div>
				</div>

				<div class="clear"></div>
			</div>
			</div>
		</article>
	</header>
	<div class="center">
		<div class="col-main">
			<div class="main-wrap">

				<div class="user-info">
					<!--标题 -->
					<div class="am-cf am-padding">
						<div class="am-fl am-cf"><strong class="am-text-danger am-text-lg">个人资料</strong> /
							<small>Personal&nbsp;information</small></div>
					</div>
					<hr />

					<!--头像 -->
					<div class="user-infoPic">
						<form enctype="multipart/form-data" id="ajax-upload-demo">
							<div class="filePic">
								<input type="file" class="inputPic" allowexts="gif,jpeg,jpg,png,bmp" accept="image/*"
									name="file" onchange="uploadFile()">
								<img class="am-circle am-img-thumbnail" id="imgId" src="{$userdata.url}" alt="" />
							</div>
						</form>
						<p class="am-form-help">头像</p>
						<div class="info-m">
							<div><b>用户名：<i>{$userdata.username}</i></b></div>
							<div class="u-level">
								<span class="rank r2">
									<s class="vip1"></s><a class="classes" href="#">等级：铜牌会员</a>
								</span>
							</div>
							<div class="u-level">
								<span class="rank r2">
									<s class="vip1"></s><a class="classes" href="#">积分：{$userdata.integral}</a>
								</span>
							</div>
						</div>
					</div>

					<!--个人信息 -->
					<div class="info-main">
						<form class="am-form am-form-horizontal" id="edit">
							<input type="hidden" name="id" value="{$userdata.id}">
							<div class="am-form-group">
								<label for="user-name2" class="am-form-label">昵称</label>
								<div class="am-form-content">
									<input type="text" id="user-name2" placeholder="{$userdata.username}"
										name="username" value="{$userdata.username}">
								</div>
							</div>


							<div class="am-form-group">
								<label class="am-form-label">性别</label>
								<div class="am-form-content sex">
									{if $userdata.sex==1}
									<label class="am-radio-inline">
										<input type="radio" name="sex" value="1" data-am-ucheck checked> 男
									</label>
									<label class="am-radio-inline">
										<input type="radio" name="sex" value="2" data-am-ucheck> 女
									</label>
									<label class="am-radio-inline">
										<input type="radio" name="sex" value="0" data-am-ucheck> 保密
									</label>
									{elseif $userdata.sex==2 /}
									<label class="am-radio-inline">
										<input type="radio" name="sex" value="1" data-am-ucheck> 男
									</label>
									<label class="am-radio-inline">
										<input type="radio" name="sex" value="2" data-am-ucheck checked> 女
									</label>
									<label class="am-radio-inline">
										<input type="radio" name="sex" value="0" data-am-ucheck> 保密
									</label>
									{else /}
									<label class="am-radio-inline">
										<input type="radio" name="sex" value="1" data-am-ucheck> 男
									</label>
									<label class="am-radio-inline">
										<input type="radio" name="sex" value="2" data-am-ucheck> 女
									</label>
									<label class="am-radio-inline">
										<input type="radio" name="sex" value="0" data-am-ucheck checked> 保密
									</label>
									{/if}

								</div>
							</div>

							<!-- <div class="am-form-group">
									<label for="user-birth" class="am-form-label">生日</label>
									<div class="am-form-content birth">
										<div class="birth-select">
											<select data-am-selected>
												<option value="a">2015</option>
												<option value="b">1987</option>
											</select>
											<em>年</em>
										</div>
										<div class="birth-select2">
											<select data-am-selected>
												<option value="a">12</option>
												<option value="b">8</option>
											</select>
											<em>月</em></div>
										<div class="birth-select2">
											<select data-am-selected>
												<option value="a">21</option>
												<option value="b">23</option>
											</select>
											<em>日</em></div>
									</div>
								</div> -->

							<div class="am-form-group">
								<label for="user-phone" class="am-form-label">电话</label>
								<div class="am-form-content">
									<input id="user-phone" placeholder="phone" type="tel" name="phone" value="{$userdata.phone}">

								</div>
							</div>
							<div class="am-form-group">
								<label for="user-email" class="am-form-label">电子邮件</label>
								<div class="am-form-content">
									<input id="user-email" placeholder="Email" type="email" readonly="readonly"
										value="{$userdata.email}" name="email">
								</div>
							</div>
							<div class="info-btn">
								<div class="am-btn am-btn-danger" id="edits">保存修改</div>
							</div>
						</form>
					</div>

				</div>

			</div>

		</div>

		<aside class="menu">
			<ul>
				<li class="person">
					<a href="index.html">个人中心</a>
				</li>
				<li class="person">
					<a href="#">个人资料</a>
					<ul>
						<li class="active"> <a href="information.html">个人信息</a></li>
						<li> <a href="address.html">收货地址</a></li>
					</ul>
				</li>
				<li class="person">
					<a href="#">我的交易</a>
					<ul>
						<li><a href="order.html">订单管理</a></li>
						<li> <a href="change.html">退款售后</a></li>
					</ul>
				</li>

				<li class="person">
					<a href="#">我的小窝</a>
					<ul>
						<li> <a href="collection.html">收藏</a></li>
						<li> <a href="foot.html">足迹</a></li>
						<li> <a href="comment.html">评价</a></li>
						<li> <a href="news.html">消息</a></li>
					</ul>
				</li>

			</ul>
		</aside>
	</div>

</body>
<script>
	$(function () {
		var isUploading = false;
		// 上传文件
		uploadFile = function () {
			var form = document.getElementById('ajax-upload-demo');
			if (isUploading) {
				layer.open({
					type: 0,
					title: '提示',
					content: "图片上传中...",
					anim: 6
				});
			}
			$.ajax({
				url: '/admin/Commodity/img',
				type: 'POST',
				cache: false,
				data: new FormData(form),
				processData: false,
				contentType: false,
				dataType: 'json',
				beforeSend: function () {
					isUploading = true;
				},
				success: function (json) {
					if (json.status == 1) {
						$.ajax({
							type: 'post',
							url: "{:url('index/user/urlimg')}",
							data: { 'url': json.info },
							dataType: 'json',
							success: function (data) {
								if (data.code == 201) {
									$("#imgId").attr('src', data.url);
									layer.open({
										type: 0,
										title: '提示',
										content: data.data,
										anim: 6
									});
								}
							}
						})
					}
				}
			});
		}

		$('#edits').on('click', function () {
			var data = decodeURIComponent($('#edit').serialize(), true);
			// console.log(data);
			//用ajax提交用户信息  
			$.ajax({
				type: 'post',
				url: "{:url('index/user/saveuser')}",
				data: data,
				dataType: 'json',
				success: function (data) {
					console.log(data);
					if (data['error_code'] == 400) {
						layer.open({
							type: 0,
							title: '警告',
							content: data['msg'],
							anim: 6
						});
					} else if (data['code'] == 202) {
						window.location = "{:url('index/user/information')}";
					} else if (data['code'] == 400) {
						layer.open({
							type: 0,
							title: '警告',
							content: data['data'],
							anim: 6
						});
					}
				}
			})
		});

	});
</script>

</html>